graph TB
    subgraph "Camada de ApresentaÃ§Ã£o"
        FE["ğŸ–¥ï¸ Frontend<br/>React 19 + Vite + Tailwind CSS 4"]
    end

    subgraph "Camada de API e OrquestraÃ§Ã£o"
        API["âš¡ API Backend<br/>FastAPI / Express"]
        AUTH["ğŸ” Supabase Auth<br/>JWT + RLS"]
    end

    subgraph "Camada de Processamento AssÃ­ncrono"
        QUEUE["ğŸ“¨ Redis<br/>Message Broker"]
        WORKER["âš™ï¸ PDF Worker<br/>Celery (Python)"]
        
        subgraph "Pipeline de ExtraÃ§Ã£o"
            DOCLING["ğŸ“„ Docling (IBM)<br/>ExtraÃ§Ã£o Estrutural"]
            PDFP["ğŸ“Š pdfplumber<br/>Tabelas"]
            GEMINI_V["ğŸ‘ï¸ Gemini 2.5 Flash<br/>Vision / OCR"]
        end
    end

    subgraph "Camada de IA (LangGraph)"
        SUPERVISOR["ğŸ§  Supervisor<br/>Complexidade"]
        ROUTER["ğŸ”€ Roteador<br/>de MatÃ©ria"]
        AGENTS["ğŸ‘¨â€âš–ï¸ Agentes Especialistas<br/>CÃ­vel / Penal / Trabalhista"]
        RAG["ğŸ” RAG Engine<br/>Few-Shot Prompting"]
        GENERATOR["ğŸ“ Gerador<br/>de Minuta"]
        VALIDATOR["âœ… Validador<br/>de Output"]
    end

    subgraph "Camada de PersistÃªncia"
        PG["ğŸ˜ PostgreSQL<br/>Supabase + pgvector"]
        REDIS_C["ğŸ’¾ Redis Cache<br/>Upstash"]
        STORAGE["ğŸ“¦ Supabase Storage<br/>PDFs e Documentos"]
    end

    subgraph "Observabilidade"
        LS["ğŸ“ˆ LangSmith<br/>Tracing de IA"]
        SENTRY["ğŸš¨ Sentry<br/>Error Tracking"]
    end

    FE -->|"Upload PDF / Consultas"| API
    API -->|"AutenticaÃ§Ã£o"| AUTH
    API -->|"Enfileira Job"| QUEUE
    QUEUE -->|"Consome Job"| WORKER
    WORKER --> DOCLING
    WORKER --> PDFP
    WORKER --> GEMINI_V
    WORKER -->|"Salva ExtraÃ§Ã£o"| PG
    
    API -->|"Inicia AnÃ¡lise"| SUPERVISOR
    SUPERVISOR --> ROUTER
    ROUTER --> AGENTS
    AGENTS -->|"Busca Precedentes"| RAG
    RAG -->|"pgvector Search"| PG
    AGENTS --> GENERATOR
    GENERATOR --> VALIDATOR
    VALIDATOR -->|"Salva AnÃ¡lise"| PG
    
    SUPERVISOR -.->|"Trace"| LS
    AGENTS -.->|"Trace"| LS
    API -.->|"Errors"| SENTRY
    FE -.->|"Errors"| SENTRY
    
    API -->|"Cache"| REDIS_C
    API -->|"Arquivos"| STORAGE
